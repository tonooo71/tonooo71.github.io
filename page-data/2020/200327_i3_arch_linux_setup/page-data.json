{"componentChunkName":"component---src-templates-blog-post-js","path":"/2020/200327_i3_arch_linux_setup/","result":{"data":{"site":{"siteMetadata":{"title":"RINotes","siteUrl":"https://tonooo71.github.io"}},"markdownRemark":{"id":"b3af08b7-ed85-5cc7-ae92-ceaa21673221","excerpt":"概要 なんでi3wmというWindow Managerを使うようになったかというと、ノートPCをArch Linux+Gnome…","html":"<h2>概要</h2>\n<p>なんでi3wmというWindow Managerを使うようになったかというと、ノートPCをArch Linux+Gnomeで使用していて以下のような気になる点があったからです。</p>\n<ul>\n<li>画面が小さいので、無駄なくウィンドウを整列させて使いたい</li>\n<li>タッチパッドでの操作がしにくいので、キーボードで基本的な操作を完結させたい</li>\n<li>Gnomeは(比較的)重い(らしい)ので、軽いウィンドウマネージャを使いたい</li>\n</ul>\n<p>実際使ってみると軽いしキーボードで操作しやすいし、なんならGUIじゃなくてCUIのアプリケーション使うようになったりといった変化もありました。</p>\n<p>ただArch Linuxをインストールした上でWindows Managerをi3wmだけインストールすると、いろいろ設定したりパッケージをインストールしたりするのがね…面倒…</p>\n<p>Arch Linuxのインストールは<a href=\"https://wiki.archlinux.jp/index.php/%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%82%AC%E3%82%A4%E3%83%89\">ArchWiki: インストールガイド</a>のとおりにやりましたがここは省略。</p>\n<h2>i3wmインストール</h2>\n<p><code class=\"language-text\">i3-wm</code>と<code class=\"language-text\">i3status</code>、<code class=\"language-text\">dmenu</code>(ランチャー)をインストールします。\n(<code class=\"language-text\">i3status</code>と<code class=\"language-text\">dmenu</code>は後で別のものに置き換えますが、設定しなくとも使えるのでまずはこれをインストールしておきます)\n初期設定でModキーをどこにするか聞かれますが、Windowsの入っていたPCならWinキーであるMod4が無難だと思います。</p>\n<p>ディスプレイマネージャとして<code class=\"language-text\">LightDM</code>、あとはターミナルを何かインストールしておきます。</p>\n<p>ノートPCなら省電力用に<code class=\"language-text\">tlp</code>とかインストールしておくのもあり。</p>\n<h3>ネットワーク設定</h3>\n<p>ネットワーク管理のためのパッケージをインストールします。(私は<code class=\"language-text\">NetworkManager</code>にしています)\n<code class=\"language-text\">NetworkManager.service</code>は<code class=\"language-text\">dhcpcd.service</code>と競合するので、<code class=\"language-text\">dhcpcd.service</code>をdisableする必要があります。</p>\n<p>Bluetoothを使用するには<code class=\"language-text\">bluez</code>と<code class=\"language-text\">bluez-utils</code>を導入します。\n(PluseAudioを使用していてBluetoothヘッドホン使いたいなら<code class=\"language-text\">pulseaudio-bluetooth</code>もインストールする必要がありそうです)\nこのままでもCLIで接続設定することができますが(<a href=\"https://wiki.archlinux.jp/index.php/Bluetooth#CLI_.E3.81.AB.E3.82.88.E3.82.8B.E8.A8.AD.E5.AE.9A\">Bluetooth: CLIによる設定</a>)、私はGUIで設定したいので<code class=\"language-text\">Blueman</code>をインストールしました。</p>\n<h3>Fcitx</h3>\n<p>日本語入力するためにFcitxとMozcをインストールします。\nあとは日本語フォントも適当に入れておきます。(Noto fontとかipafontとか)</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> pacman -S fcitx fcitx-mozc fcitx-im fcitx-configtool\n<span class=\"token function\">sudo</span> pacman -S otf-ipafont ttf-dejavu</code></pre></div>\n<p>設定</p>\n<p>~/.xintrc</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">export DefaultImModule=fcitx\nexport GTK_IM_MODULE=fcitx\nexport QT_IM_MODULE=fcitx\nexport XMODIFIERS=&quot;@im=fcitx&quot;</code></pre></div>\n<p>fcitxを起動したら、fcitx-configtoolから適当なキーボードとmozcを追加します。</p>\n<h2>i3関連</h2>\n<p>i3は<code class=\"language-text\">~/.config/i3/config</code>に設定を記述することでカスタマイズが可能です。\nここで設定可能な項目は、だいたいキーバインドとアプリケーション設定がほとんどです。</p>\n<h3>キーバインド</h3>\n<p>ほとんどデフォルトのままですが、追加した設定をいくつか記述します\n3つめのはマルチディスプレイのときにワークスペースを移動するためのものです。</p>\n<p>~/.config/i3/config</p>\n<div class=\"gatsby-highlight\" data-language=\"conf\"><pre class=\"language-conf\"><code class=\"language-conf\"># Font for window titles. Will also be used by the bar unless a different font\n# is used in the bar {} block below.\n#font pango:monospace 8\nfont pango:Dejavu Sans,IPAGothic 10\n\n# Prior=Page up Next=Page Down\nbindsym $mod+Prior workspace prev\nbindsym $mod+Next workspace next\n\n#move workspace\nbindsym $mod+Shift+Prior move workspace to output up\nbindsym $mod+Shift+Next move workspace to output down</code></pre></div>\n<h3>ハードウェアキーの設定</h3>\n<p>特殊キーの名前を調べるには<code class=\"language-text\">xorg-xev</code>パッケージの<code class=\"language-text\">xev</code>コマンドで可能です。</p>\n<h4>輝度</h4>\n<p><a href=\"https://wiki.archlinux.jp/index.php/%E3%83%90%E3%83%83%E3%82%AF%E3%83%A9%E3%82%A4%E3%83%88\">バックライト(ArchWiki)</a>を参照。\n輝度の調整をキーに割り当てるには、<code class=\"language-text\">xorg-xbacklight</code>パッケージの<code class=\"language-text\">xbacklight</code>コマンドを使ってconfigに書き込みます。</p>\n<p>~/.config/i3/config</p>\n<div class=\"gatsby-highlight\" data-language=\"conf\"><pre class=\"language-conf\"><code class=\"language-conf\"># Screen brightness controls\nbindsym XF86MonBrightnessUp exec xbacklight -inc 10\nbindsym XF86MonBrightnessDown exec xbacklight -dec 10</code></pre></div>\n<h4>音量</h4>\n<p>まず<code class=\"language-text\">pulseaudio</code>と設定ツールである<code class=\"language-text\">pavucontrol</code>をインストールします。\n<code class=\"language-text\">pluseaudio</code>のフロントエンドとしては<code class=\"language-text\">pamixer</code>などが存在します。(あとで使うのでインストールしておきました)\nあとflashの音を出すために<code class=\"language-text\">pulseaudio-alsa</code>が必要です。</p>\n<p>~/.config/i3/config</p>\n<div class=\"gatsby-highlight\" data-language=\"conf\"><pre class=\"language-conf\"><code class=\"language-conf\"># Pulse Audio controls\nbindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume 0 +5%\nbindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume 0 -5%\nbindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute 0 toggle</code></pre></div>\n<h4>スクリーンショット</h4>\n<p>せっかくなのでスクリーンショットもPrtScrキーで動作させます。\nスクリーンショットには<code class=\"language-text\">imagemagick</code>パッケージを使用します。\n]\n~/.config/i3/config</p>\n<div class=\"gatsby-highlight\" data-language=\"conf\"><pre class=\"language-conf\"><code class=\"language-conf\"># screenshot\nbindsym Print exec --no-startup-id import -window root ~/Pictures/screenshot`date &quot;+%y%m%d%H%M&quot;`.jpg</code></pre></div>\n<h3>その他</h3>\n<h4>壁紙</h4>\n<p><code class=\"language-text\">feh</code>で設定します。(fehは軽量の画像ビューアです)</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">feh --bg-scale ~/Pictures/wallpaper.png</code></pre></div>\n<p>最後に設定した壁紙(とコマンド)を使用するのであれば</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">~/.fehbg</code></pre></div>\n<p>で大丈夫です。</p>\n<h4>外部モニタ</h4>\n<p>まず<code class=\"language-text\">xrandr</code>をインストールします。\nそしてHDMIポートやVGAポートに接続された際に、自動的に画面を拡張するようなスクリプトを書いた上で、自動起動させておきます。(スクリプトはご自身の環境に合わせてください)</p>\n<p>~/.config/i3/config</p>\n<div class=\"gatsby-highlight\" data-language=\"conf\"><pre class=\"language-conf\"><code class=\"language-conf\">exec --no-startup-id ~/.config/i3/script/monitor_detect.sh</code></pre></div>\n<p>~/.config/i3/script/monitor_detect.sh</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n<span class=\"token comment\">#st_prev=$(cat /sys/class/drm/card0-HDMI-A-1/status)</span>\n<span class=\"token assign-left variable\">st_prev</span><span class=\"token operator\">=</span><span class=\"token string\">\"disconnected\"</span>\n\n<span class=\"token keyword\">while</span> <span class=\"token builtin class-name\">:</span>\n<span class=\"token keyword\">do</span>\n    <span class=\"token assign-left variable\">st_next</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">cat</span> /sys/class/drm/card0-HDMI-A-1/status<span class=\"token variable\">)</span></span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token variable\">$st_prev</span> <span class=\"token operator\">!=</span> <span class=\"token variable\">$st_next</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n        <span class=\"token assign-left variable\">st_prev</span><span class=\"token operator\">=</span><span class=\"token variable\">$st_next</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token variable\">$st_next</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"connected\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n            xrandr --output eDP1 --mode 1600x900 --output HDMI1 --auto --above eDP1\n        <span class=\"token keyword\">else</span>\n            xrandr --output eDP1 --mode 1600x900 --output HDMI1 --off\n        <span class=\"token keyword\">fi</span>\n        ~/.fehbg\n    <span class=\"token keyword\">fi</span>\n    <span class=\"token function\">sleep</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">done</span></code></pre></div>\n<h4>蓋を閉じたときの動作</h4>\n<p>ノートPCなので、蓋を閉じたらサスペンドするように変更します。</p>\n<p>/etc/systemd/logind.conf</p>\n<div class=\"gatsby-highlight\" data-language=\"conf\"><pre class=\"language-conf\"><code class=\"language-conf\">HandleLidSwitch=suspend</code></pre></div>\n<h4>画面ロック</h4>\n<p><code class=\"language-text\">i3lock</code>が標準で推奨されているようですが、マルチモニタで壁紙がずれるので<code class=\"language-text\">light-locker</code>を使います。\nこれだとLightDMのログイン画面と同じになります。\n<code class=\"language-text\">light-locker</code>をサスペンドから起動した後に使用するには、</p>\n<p>~/.config/i3/config</p>\n<div class=\"gatsby-highlight\" data-language=\"conf\"><pre class=\"language-conf\"><code class=\"language-conf\">exec --no-startup-id light-locker --lock-on-suspend</code></pre></div>\n<h3>dmenuの代替</h3>\n<p><code class=\"language-text\">rofi</code>が上位互換として使えます。\nこれについてはこちらのサイト(<a href=\"http://malkalech.com/rofi_window_switcher\">Jenemal Notes</a>)に詳しく説明されているので割愛します。</p>\n<h3>i3statusの代替</h3>\n<p>自作スクリプトを適用できたり、見た目をより柔軟に変えられるパッケージが存在します。\nシンプルながらある程度の拡張性がある<code class=\"language-text\">i3blocks</code>と、外観までかなり自由に変えることができる<code class=\"language-text\">polybar</code>があります。\n詳しい設定は省きますが、<code class=\"language-text\">i3blocks</code>も<code class=\"language-text\">polybar</code>も設定ファイルはGitHubに上げていますので良ければ。\n<code class=\"language-text\">polybar</code>に関しては<a href=\"https://tonooo71.github.io/post/180607_polybar_setting/\">別記事</a>にも書いています。</p>\n<h3>config(一部)</h3>\n<p>~/.config/i3/config</p>\n<div class=\"gatsby-highlight\" data-language=\"conf\"><pre class=\"language-conf\"><code class=\"language-conf\"># start a terminal\nbindsym $mod+Return exec termite\n\n# kill focused window\nbindsym $mod+Shift+q kill\n\n# start a program launcher\nbindsym $mod+d exec ~/.config/i3/script/rofi_launch.sh\n\n# switch to workspace\nbindsym $mod+Zenkaku_Hankaku exec --no-startup-id ~/.config/polybar/scripts/add_ws.py\nbindsym $mod+Prior workspace prev\nbindsym $mod+Next workspace next\n\n#move workspace\nbindsym $mod+Shift+Prior move workspace to output up\nbindsym $mod+Shift+Next move workspace to output down\n\n# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)\nbindsym $mod+Shift+r exec --no-startup-id ~/.config/polybar/launch.sh restart\n\n# color\n# class                 border  backgr. text    indicator child_border\nclient.focused          #98c379 #98c379 #282c34 #98c379   #545862\nclient.focused_inactive #545862 #545862 #abb2bf #545862   #545862\nclient.unfocused        #545862 #545862 #abb2bf #545862   #545862\n\n# Pulse Audio controls\nbindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ +5%\nbindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ -5%\nbindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute @DEFAULT_SINK@ toggle\n\n# backlight\nbindsym XF86MonBrightnessUp exec xbacklight -inc 10\nbindsym XF86MonBrightnessDown exec xbacklight -dec 10\n\n# screenshot\nbindsym Print exec --no-startup-id import -window root ~/Pictures/screenshot`date &quot;+%y%m%d%H%M&quot;`.jpg\n\n# startup apps\nexec --no-startup-id xrandr --output eDP1 --mode 1600x900 --output HDMI1 --off\nexec --no-startup-id ~/.config/i3/script/monitor_detect.sh\nexec --no-startup-id ~/.fehbg\nexec --no-startup-id fcitx\nexec --no-startup-id ~/.config/polybar/launch.sh\nexec --no-startup-id light-locker --lock-on-suspend\nexec --no-startup-id xset s off -dpms\nexec --no-startup-id dropbox\n\n# application setting(float)\nfor_window [class=&quot;Lxappearance&quot;] floating enable, resize set 600 400\nfor_window [class=&quot;Pavucontrol&quot;] floating enable, resize set 600 400\nfor_window [class=&quot;Fcitx-config-gtk3&quot;] floating enable, resize set 600 400\nfor_window [class=&quot;mozc_tool&quot;] floating enable, resize set 600 400\nfor_window [class=&quot;Blueman-manager&quot;] floating enable, resize set 600 400\nfor_window [class=&quot;Gnome-terminal&quot;] floating enable move absolute position 990 px 470 px, resize set 600 400</code></pre></div>\n<p>最後のapplication setting(float)では、タイルではなく通常のウィンドウのような感じで表示させるアプリの指定ができます。\n基本的には設定ツールに適用しています。\n<code class=\"language-text\">lxappearance</code>はGTK+テーマやアイコン、ポインタを変更することができるツールです。\nアプリのクラス名を調べるためには<code class=\"language-text\">xorg-xprop</code>パッケージをインストールして、</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">xprop <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> WM_CLASS</code></pre></div>\n<p>任意のアプリの画面をクリックすると</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">WM_CLASS<span class=\"token punctuation\">(</span>STRING<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"urxvt\"</span>, <span class=\"token string\">\"URxvt\"</span></code></pre></div>\n<p>こんな感じで表示されます。</p>\n<h3>最後に</h3>\n<p>本当に使いやすいです。\n基本的にキーボードで操作できるということもあって、同様にキーボードで操作できるCUIアプリケーションを使うようになりましたね。(<code class=\"language-text\">ranger</code>とか<code class=\"language-text\">neovim</code>とか<code class=\"language-text\">ncmpcpp</code>とか)\nメモリも起動時で0.2~0.3GB程度しか使用しておらずかなり軽量なのも良いです。</p>\n<h3>Source</h3>\n<p><a href=\"https://github.com/tonooo71/dotfiles\">GitHub: tonooo71/dotfiles</a></p>\n<h3>Qiita</h3>\n<p><a href=\"https://qiita.com/Tonooo/items/256fcaffd7113b1ed018\">Qiita: i3+Arch Linux初期環境構築まとめ</a></p>","frontmatter":{"title":"i3+Arch Linux初期環境構築まとめ","date":"August 04, 2018","description":"Arch Linuxにタイル型ウィンドウマネージャi3wmを入れた時のセットアップまとめです","tags":"i3wm Linux ArchLinux"}}},"pageContext":{"slug":"/2020/200327_i3_arch_linux_setup/","previous":{"fields":{"slug":"/2018/180802_virtualbox_vkms/180802_virtualbox_vkms/"},"frontmatter":{"title":"デュアルブートでVirtualBox","tags":"Linux ArchLinux"}},"next":{"fields":{"slug":"/2018/180811_neovimlsp/180811_neovimlsp/"},"frontmatter":{"title":"NeovimでLSPを使う","tags":"Neovim"}}}}}