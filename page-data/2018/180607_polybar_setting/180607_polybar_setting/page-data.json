{"componentChunkName":"component---src-templates-blog-post-js","path":"/2018/180607_polybar_setting/180607_polybar_setting/","result":{"data":{"site":{"id":"Site","siteMetadata":{"title":"RINotes"}},"markdownRemark":{"id":"48beb8cb-a718-5605-a664-71d1172597cd","excerpt":"外観  色はNeoVimのOnedarkテーマに揃えた i3blocksよりも色々設定できたり便利になってよかった、思ってたよりもメモリ消費量も変わらなかったしいい感じ ワークスペース 左端にあるやつ、使用していないワークスペースも常に表示させておきたかったんだけど、そういうのは現状のi3wm…","html":"<h2>外観</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/877af3c5bfba5be1925af38feaa25183/b17f8/screenshot1806071323.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAEEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEA/9oADAMBAAIQAxAAAAHlVErQL//EABkQAAIDAQAAAAAAAAAAAAAAAAECABARMf/aAAgBAQABBQKz2Koz/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8BV//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABkQAAIDAQAAAAAAAAAAAAAAAAABEBGBIf/aAAgBAQABPyHTS2LTQz0j/9oADAMBAAIAAwAAABC0D//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/EFf/xAAVEQEBAAAAAAAAAAAAAAAAAAAAAf/aAAgBAgEBPxBYf//EABoQAQACAwEAAAAAAAAAAAAAAAEAESExcZH/2gAIAQEAAT8QtXK6scaTCjb7AEFBEl7tes//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screenshot1806071323\"\n        title=\"Screenshot1806071323\"\n        src=\"/static/877af3c5bfba5be1925af38feaa25183/1c72d/screenshot1806071323.jpg\"\n        srcset=\"/static/877af3c5bfba5be1925af38feaa25183/a80bd/screenshot1806071323.jpg 148w,\n/static/877af3c5bfba5be1925af38feaa25183/1c91a/screenshot1806071323.jpg 295w,\n/static/877af3c5bfba5be1925af38feaa25183/1c72d/screenshot1806071323.jpg 590w,\n/static/877af3c5bfba5be1925af38feaa25183/a8a14/screenshot1806071323.jpg 885w,\n/static/877af3c5bfba5be1925af38feaa25183/fbd2c/screenshot1806071323.jpg 1180w,\n/static/877af3c5bfba5be1925af38feaa25183/b17f8/screenshot1806071323.jpg 1600w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>色はNeoVimのOnedarkテーマに揃えた</p>\n<p>i3blocksよりも色々設定できたり便利になってよかった、思ってたよりもメモリ消費量も変わらなかったしいい感じ</p>\n<h3>ワークスペース</h3>\n<p>左端にあるやつ、使用していないワークスペースも常に表示させておきたかったんだけど、そういうのは現状のi3wmでは無理なのかな？</p>\n<p>”+“はワークスペースを一つ増やすボタン、使用していないワークスペースのうち最も若い番号のワークスペースに遷移する</p>\n<p>Virtual Box起動させるとModキーが使用できなくなってワークスペース増やせないのが不便だったので作った</p>\n<p>キーバインディングとしてはMod+HankakuZenkakuにしてある</p>\n<p>あんま使わないかなーと思ってたけど、何番のワークスペースがあいているか確認してからワークスペース開いていた動作がなくなるのもあって結構よく使うようになった</p>\n<h3>MPD</h3>\n<p>音楽鳴らせますね</p>\n<p>i3blockだとクリックの種類で再生だったり曲の遷移だったりを変えていたのが、Polybarだた各ボタンで操作可能なのが便利</p>\n<h3>システムトレイ</h3>\n<p>表示されるのは次の項目</p>\n<ul>\n<li>Bluetooth接続状態(接続時のみ表示)</li>\n<li>アップデートの有無(アップデートがあるときだけ表示)</li>\n<li>ネットワーク(有線or無線-SSID)</li>\n<li>メモリ消費量</li>\n<li>バッテリー</li>\n<li>音量</li>\n<li>時計</li>\n</ul>\n<h2>設定ファイル</h2>\n<h3>launch.sh</h3>\n<p>Polybar、Mod+Shift+rでi3wmを再読込するとワークスペースのモジュールが動作しなくなってしまうので、そのへんを考慮した</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">#!/bin/bash\n\n## restart i3\nif [[ $1 = &quot;restart&quot; ]]; then\n\ti3-msg restart\n\tsleep 1\nfi\n\n# Terminate already running bar instances\nkillall -q polybar\n\n# Wait until the processes have been shut down\nwhile pgrep -u $UID -x polybar &gt;/dev/null; do sleep 1; done\n\n# Launch bar\npolybar eDP1 &amp;\npolybar HDMI1 &amp;\npolybar DP2</code></pre></div>\n<p>引数に<code class=\"language-text\">restart</code>を書くとi3wmを再読込してからPolybarを再起動する</p>\n<h3>config</h3>\n<p>Polybarはもともとモジュールをいくつも持っていて、デフォルトだとそれらから構成されているんだけど、若干出力がクドかったり冗長だなと感じたのでi3blocksのときに作ったモジュールをほとんど流用した</p>\n<p>カスタムモジュールを使うのも結構楽だったので、そのへんはWikiがちゃんと充実してるから見ながらやればだいたいできると思う</p>\n<div class=\"gatsby-highlight\" data-language=\"conf\"><pre class=\"language-conf\"><code class=\"language-conf\">[colors]\nmono0 = #282c34\nmono1 = #545862\nmono2 = #abb2bf\nmono3 = #c8ccd4\nmono4 = #353b45\nred = #e06c75\ngreen = #98c379\nyellow = #e5c07b\nblue = #61afef\npurple = #c678dd\nteal = #56b6c2\n\n[bar/eDP1]\nmonitor = ${env:MONITOR:eDP1}\nbottom = true\nfixed-center = true\n\nwidth = 100%\nheight = 25\noffset-x = 0%\noffset-y = 0%\nradius = 0.0\n\nbackground = ${colors.mono0}\nforeground = ${colors.green}\n\nline-size = 3\nline-color = #f00\n\nborder-size = 0\nborder-color = #00282c34\n\npadding-left = 0\npadding-right = 0\n\nmodule-margin-left = 0\nmodule-margin-right = 0\n\nfont-0 = Source Han Code JP H:pixelsize=11;2\nfont-1 = FontAwesome:pixelsize=12;3\n\nmodules-left = i3 add_ws\nmodules-center = ncmpcpp mpd\nmodules-right = bluetooth update network memory battery volume date\n\nseparator =\ndim-value = 1.0\n\n;tray-position = \n;tray-padding = 0\n;tray-transparent = false\n;tray-background = ${root.background}\n\n;wm-restack = i3\n;override-redirect = true\nenable-ipc = true\n\nscroll-up = i3wm-wsnext\nscroll-down = i3wm-wsprev\n\ncursor-click = pointer\ncursor-scroll = default\n\n[bar/HDMI1]\nmonitor = ${env:MONITOR:HDMI1}\n(略)\n\n[bar/DP2]\nmonitor = ${env:MONITOR:DP2}\n(略)\n\n[module/i3]\ntype = internal/i3\nformat = &lt;label-state&gt; &lt;label-mode&gt;\nindex-sort = true\nwrapping-scroll = false\n;label-mode-padding = 2\n;label-mode-foreground = #000\n;label-mode-background = ${colors.mono0}\n\n; focused = Active workspace on focused monitor\nlabel-focused = %index%\nlabel-focused-background = ${colors.green}\nlabel-focused-foreground = ${colors.mono0}\nlabel-focused-padding = 2\n\n; unfocused = Inactive workspace on any monitor\nlabel-unfocused = %index%\nlabel-unfocused-background = ${colors.mono4}\nlabel-unfocused-foreground = ${colors.mono2}\nlabel-unfocused-padding = 2\n\n; visible = Active workspace on unfocused monitor\nlabel-visible = %index%\nlabel-visible-background = ${colors.mono4}\nlabel-visible-foreground = ${colors.mono2}\nlabel-visible-padding = 2\n\n; urgent = Workspace with urgency hint set\nlabel-urgent = %index%\nlabel-urgent-background = ${colors.red}\nlabel-urgent-foreground = ${colors.mono0}\nlabel-urgent-padding = 2\n\n[module/add_ws]\ntype = custom/text\ncontent = \ncontent-padding = 1\ncontent-background = ${colors.mono4}\ncontent-foreground = ${colors.mono2}\nclick-left = exec ~/.config/polybar/scripts/add_ws.py\n\n[module/ncmpcpp]\ntype = custom/text\ncontent = &quot; &quot;\nclick-left = exec gnome-terminal -- ncmpcpp &amp;\nclick-right = exec gnome-terminal -- ncmpcpp &amp;\n\n[module/mpd]\ntype = internal/mpd\nformat-online = &lt;icon-prev&gt; &lt;icon-stop&gt; &lt;toggle&gt; &lt;icon-next&gt; &lt;label-song&gt;\n\nicon-prev = \nicon-stop = \nicon-play = \nicon-pause = \nicon-next = \n\nlabel-song-maxlen = 50\nlabel-song-ellipsis = true\n\n[module/bluetooth]\ntype = custom/script\nexec = echo &quot;%{F#98c379}&quot;\nexec-if = echo info | bluetoothctl | grep &#39;Device&#39;\ninterval = 10\nclick-left = exec blueman-manager\nclick-right = exec blueman-manager\nformat-padding = 1\nformat-background = ${colors.mono4}\nformat-foreground = ${colors.mono2}\n\n[module/update]\ntype = custom/script\nexec = echo &quot;%{F#e5c07b} $(checkupdates | wc -l)&quot;\nexec-if = checkupdates | grep &#39;\\-&gt;&#39;\ninterval = 3600\nformat-padding = 1\nformat-background = ${colors.mono4}\nformat-foreground = ${colors.mono2}\n\n[module/network]\ntype = custom/script\nexec = ~/.config/polybar/scripts/network.sh\ninterval = 10\nclick-left = exec gnome-terminal -- nmtui &amp;\nclick-right = exec gnome-terminal -- nmtui &amp;\nformat-padding = 1\nformat-background = ${colors.mono4}\nformat-foreground = ${colors.mono2}\n\n[module/memory]\ntype = custom/script\nexec = ~/.config/polybar/scripts/memory.sh\ninterval = 10\nformat-padding = 1\nformat-background = ${colors.mono4}\nformat-foreground = ${colors.mono2}\n\n[module/battery]\ntype = custom/script\nexec = ~/.config/polybar/scripts/battery.sh\ninterval = 20\nformat-padding = 1\nformat-background = ${colors.mono4}\nformat-foreground = ${colors.mono2}\n\n[module/volume]\ntype = custom/script\nexec = ~/.config/polybar/scripts/volume.sh\nclick-left = exec pactl set-sink-mute @DEFAULT_SINK@ toggle\nclick-right = exec pavucontrol &amp;\ninterval = 1\nformat-padding = 1\nformat-background = ${colors.mono4}\nformat-foreground = ${colors.mono2}\n\n[module/date]\ntype = custom/script\nexec = date &#39;+%H:%M&#39;\nformat-prefix = &quot; &quot;\ninterval = 60\nformat-background = ${colors.green}\nformat-foreground = ${colors.mono0}\nformat-padding = 1\n\n[settings]\nscreenchange-reload = true\n;compositing-background = xor\n;compositing-background = screen\n;compositing-foreground = source\n;compositing-border = over\n\n[global/wm]\nmargin-top = 5\nmargin-bottom = 5\n\n; vim:ft=dosini</code></pre></div>\n<h3>Scripts</h3>\n<p>i3blocksで使っていたのは省略して、新しく作ったのを紹介</p>\n<p>ワークスペース増やすボタンのやつです、ほんとはシェルスクリプトで書ければよかったんだけどPythonで書くのが簡単そうだったので逃げた</p>\n<p>i3wmにはPythonモジュールがあって結構いろいろ使うことができるみたい</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">#!/usr/bin/python</span>\n<span class=\"token keyword\">import</span> subprocess\n<span class=\"token keyword\">import</span> i3\n\nmax_ws <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\nws_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># get a list of workspaces</span>\n<span class=\"token keyword\">for</span> workspace <span class=\"token keyword\">in</span> i3<span class=\"token punctuation\">.</span>get_workspaces<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># get the workspace tree data</span>\n    workspace_tree <span class=\"token operator\">=</span> i3<span class=\"token punctuation\">.</span><span class=\"token builtin\">filter</span><span class=\"token punctuation\">(</span>num<span class=\"token operator\">=</span>workspace<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'num'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    ws_list<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>workspace<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'num'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> ws_list<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> i<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> max_ws <span class=\"token keyword\">and</span> <span class=\"token keyword\">not</span> i<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n        subprocess<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'i3-msg'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'workspace'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">break</span></code></pre></div>\n<h2>Reference</h2>\n<p><a href=\"https://github.com/tonooo71/dotfiles/tree/master/.config/polybar\">GitHub-tonooo71:polybar</a></p>","frontmatter":{"title":"Polybarの設定終わったぞ","date":"June 07, 2018","description":null}}},"pageContext":{"slug":"/2018/180607_polybar_setting/180607_polybar_setting/","previous":{"fields":{"slug":"/2018/180511_polybar/180511_polybar/"},"frontmatter":{"title":"Polybar導入するぞ"}},"next":{"fields":{"slug":"/2018/180619_enscript/180619_enscript/"},"frontmatter":{"title":"ソースコードをPDFで出力したい"}}}}}